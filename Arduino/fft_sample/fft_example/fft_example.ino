/*
  Example of use of the FFT libray
        Copyright (C) 2014 Enrique Condes
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

/*
  In this example, the Arduino simulates the sampling of a sinusoidal 1000 Hz
  signal with an amplitude of 100, sampled at 5000 Hz. Samples are stored
  inside the vReal array. The samples are windowed according to Hamming
  function. The FFT is computed using the windowed samples. Then the magnitudes
  of each of the frequencies that compose the signal are calculated. Finally,
  the frequency with the highest peak is obtained, being that the main frequency
  present in the signal.
*/

#include "arduinoFFT.h"

arduinoFFT FFT = arduinoFFT(); /* Create FFT object */
/*
These values can be changed in order to evaluate the functions
*/
const uint16_t samples = 4096; //This value MUST ALWAYS be a power of 2
const double signalFrequency = 1;
const double samplingFrequency = 666666;
const uint8_t amplitude = 100;
/*
These are the input and output vectors
Input vectors receive computed results from FFT
*/
double vReal[samples]={-0.053,-0.057,-0.059,-0.063,-0.065,-0.066,-0.067,-0.067,-0.067,-0.066,-0.065,-0.062,-0.058,-0.054,-0.047,-0.027,-0.013,-0.005,0.005,-0.011,-0.022,-0.026,-0.025,-0.021,-0.016,-0.010,-0.005,0.000,0.004,0.007,0.009,0.010,0.011,0.012,0.011,0.010,0.007,0.004,0.000,-0.004,-0.008,-0.013,-0.017,-0.022,-0.028,-0.034,-0.039,-0.042,-0.047,-0.050,-0.054,-0.057,-0.060,-0.062,-0.064,-0.063,-0.062,-0.063,-0.062,-0.060,-0.058,-0.056,-0.052,-0.048,-0.043,-0.039,-0.035,-0.030,-0.025,-0.020,-0.016,-0.012,-0.008,-0.005,-0.003,0.000,0.003,0.005,0.006,0.007,0.007,0.007,0.006,0.006,0.004,0.001,0.000,-0.003,-0.006,-0.010,-0.014,-0.019,-0.023,-0.027,-0.030,-0.033,-0.037,-0.041,-0.044,-0.046,-0.049,-0.050,-0.051,-0.052,-0.053,-0.053,-0.053,-0.052,-0.052,-0.051,-0.050,-0.047,-0.044,-0.040,-0.036,-0.032,-0.028,-0.025,-0.023,-0.021,-0.019,-0.016,-0.013,-0.011,-0.009,-0.006,-0.005,-0.003,-0.002,-0.002,-0.003,-0.002,-0.002,-0.003,-0.004,-0.006,-0.008,-0.010,-0.012,-0.015,-0.017,-0.019,-0.022,-0.025,-0.027,-0.030,-0.033,-0.036,-0.038,-0.040,-0.042,-0.042,-0.043,-0.045,-0.045,-0.045,-0.044,-0.042,-0.041,-0.042,-0.042,-0.040,-0.039,-0.036,-0.035,-0.033,-0.031,-0.028,-0.026,-0.024,-0.022,-0.020,-0.018,-0.016,-0.015,-0.013,-0.012,-0.012,-0.011,-0.010,-0.009,-0.008,-0.008,-0.009,-0.009,-0.010,-0.011,-0.012,-0.013,-0.013,-0.016,-0.018,-0.021,-0.023,-0.025,-0.027,-0.029,-0.030,-0.031,-0.032,-0.033,-0.035,-0.036,-0.037,-0.038,-0.038,-0.038,-0.039,-0.039,-0.040,-0.040,-0.039,-0.039,-0.038,-0.037,-0.035,-0.034,-0.032,-0.031,-0.028,-0.026,-0.025,-0.024,-0.021,-0.020,-0.018,-0.018,-0.017,-0.016,-0.014,-0.013,-0.013,-0.013,-0.012,-0.012,-0.010,-0.011,-0.011,-0.012,-0.013,-0.014,-0.015,-0.015,-0.015,-0.017,-0.019,-0.021,-0.023,-0.026,-0.027,-0.028,-0.030,-0.032,-0.035,-0.036,-0.037,-0.038,-0.040,-0.041,-0.041,-0.041,-0.041,-0.040,-0.040,-0.038,-0.037,-0.037,-0.037,-0.036,-0.034,-0.032,-0.030,-0.028,-0.027,-0.025,-0.024,-0.022,-0.020,-0.017,-0.015,-0.014,-0.013,-0.011,-0.010,-0.010,-0.009,-0.008,-0.009,-0.009,-0.010,-0.010,-0.011,-0.011,-0.012,-0.013,-0.015,-0.017,-0.020,-0.022,-0.025,-0.027,-0.028,-0.030,-0.033,-0.036,-0.038,-0.040,-0.042,-0.042,-0.042,-0.043,-0.043,-0.044,-0.046,-0.046,-0.044,-0.043,-0.041,-0.038,-0.036,-0.034,-0.032,-0.031,-0.028,-0.024,-0.021,-0.020,-0.018,-0.015,-0.014,-0.011,-0.009,-0.007,-0.006,-0.005,-0.005,-0.005,-0.005,-0.005,-0.006,-0.006,-0.008,-0.010,-0.012,-0.013,-0.015,-0.017,-0.019,-0.022,-0.025,-0.027,-0.030,-0.034,-0.036,-0.038,-0.040,-0.042,-0.042,-0.044,-0.046,-0.045,-0.046,-0.047,-0.048,-0.048,-0.047,-0.046,-0.043,-0.040,-0.037,-0.034,-0.032,-0.029,-0.026,-0.023,-0.021,-0.018,-0.014,-0.011,-0.009,-0.008,-0.006,-0.005,-0.004,-0.003,-0.002,-0.001,-0.001,-0.002,-0.003,-0.004,-0.007,-0.009,-0.011,-0.014,-0.016,-0.018,-0.021,-0.023,-0.026,-0.030,-0.034,-0.038,-0.041,-0.044,-0.046,-0.047,-0.048,-0.049,-0.050,-0.051,-0.052,-0.051,-0.049,-0.048,-0.045,-0.042,-0.040,-0.037,-0.034,-0.032,-0.030,-0.027,-0.023,-0.021,-0.016,-0.013,-0.010,-0.007,-0.006,-0.005,-0.003,0.000,0.000,0.000,0.000,0.000,-0.001,-0.002,-0.003,-0.006,-0.008,-0.010,-0.012,-0.015,-0.017,-0.021,-0.026,-0.029,-0.033,-0.036,-0.039,-0.042,-0.044,-0.047,-0.048,-0.050,-0.051,-0.051,-0.052,-0.052,-0.050,-0.049,-0.048,-0.046,-0.043,-0.042,-0.040,-0.036,-0.032,-0.028,-0.025,-0.022,-0.019,-0.016,-0.014,-0.011,-0.008,-0.005,-0.002,0.000,0.001,0.002,0.002,0.002,0.002,0.001,-0.001,-0.003,-0.005,-0.007,-0.010,-0.013,-0.017,-0.019,-0.022,-0.026,-0.029,-0.033,-0.038,-0.041,-0.044,-0.047,-0.049,-0.050,-0.050,-0.051,-0.051,-0.051,-0.050,-0.050,-0.049,-0.049,-0.047,-0.044,-0.042,-0.039,-0.036,-0.033,-0.029,-0.024,-0.020,-0.017,-0.013,-0.010,-0.007,-0.005,-0.002,-0.001,0.001,0.002,0.002,0.000,0.000,-0.001,-0.002,-0.003,-0.004,-0.006,-0.010,-0.012,-0.014,-0.017,-0.021,-0.024,-0.029,-0.033,-0.036,-0.039,-0.041,-0.044,-0.045,-0.047,-0.048,-0.050,-0.051,-0.051,-0.051,-0.050,-0.049,-0.048,-0.047,-0.044,-0.041,-0.038,-0.036,-0.032,-0.029,-0.025,-0.022,-0.020,-0.016,-0.013,-0.008,-0.006,-0.005,-0.003,-0.002,-0.001,0.000,0.000,0.000,-0.002,-0.003,-0.005,-0.006,-0.007,-0.009,-0.010,-0.012,-0.015,-0.018,-0.022,-0.026,-0.029,-0.032,-0.036,-0.040,-0.043,-0.045,-0.046,-0.048,-0.048,-0.049,-0.049,-0.049,-0.048,-0.048,-0.047,-0.044,-0.043,-0.042,-0.040,-0.036,-0.034,-0.031,-0.029,-0.025,-0.022,-0.018,-0.015,-0.012,-0.009,-0.008,-0.006,-0.004,-0.003,-0.002,-0.001,0.000,-0.001,0.000,-0.001,-0.004,-0.006,-0.008,-0.012,-0.015,-0.017,-0.019,-0.022,-0.025,-0.028,-0.030,-0.032,-0.035,-0.038,-0.040,-0.043,-0.045,-0.046,-0.047,-0.047,-0.049,-0.049,-0.049,-0.048,-0.046,-0.043,-0.042,-0.040,-0.038,-0.036,-0.033,-0.029,-0.025,-0.022,-0.019,-0.016,-0.015,-0.012,-0.009,-0.007,-0.006,-0.005,-0.004,-0.004,-0.004,-0.003,-0.004,-0.004,-0.005,-0.006,-0.008,-0.010,-0.014,-0.016,-0.019,-0.021,-0.024,-0.026,-0.028,-0.030,-0.033,-0.036,-0.039,-0.040,-0.042,-0.044,-0.046,-0.046,-0.047,-0.047,-0.045,-0.044,-0.043,-0.042,-0.040,-0.038,-0.036,-0.034,-0.032,-0.030,-0.028,-0.025,-0.023,-0.020,-0.019,-0.017,-0.014,-0.011,-0.009,-0.007,-0.006,-0.004,-0.005,-0.005,-0.005,-0.006,-0.006,-0.006,-0.008,-0.011,-0.013,-0.016,-0.019,-0.021,-0.023,-0.025,-0.027,-0.029,-0.031,-0.032,-0.035,-0.037,-0.039,-0.041,-0.042,-0.044,-0.044,-0.044,-0.044,-0.043,-0.041,-0.040,-0.040,-0.038,-0.037,-0.036,-0.034,-0.031,-0.029,-0.025,-0.023,-0.020,-0.019,-0.018,-0.016,-0.013,-0.011,-0.010,-0.009,-0.009,-0.009,-0.008,-0.008,-0.009,-0.009,-0.011,-0.012,-0.012,-0.013,-0.013,-0.017,-0.019,-0.022,-0.025,-0.027,-0.028,-0.029,-0.031,-0.033,-0.034,-0.037,-0.037,-0.038,-0.038,-0.039,-0.040,-0.040,-0.040,-0.040,-0.039,-0.039,-0.039,-0.038,-0.037,-0.035,-0.032,-0.030,-0.029,-0.026,-0.024,-0.021,-0.018,-0.016,-0.014,-0.014,-0.013,-0.012,-0.012,-0.011,-0.011,-0.011,-0.012,-0.012,-0.013,-0.013,-0.013,-0.013,-0.015,-0.016,-0.018,-0.020,-0.022,-0.024,-0.025,-0.025,-0.027,-0.029,-0.031,-0.032,-0.034,-0.035,-0.036,-0.038,-0.039,-0.039,-0.039,-0.039,-0.039,-0.038,-0.037,-0.036,-0.035,-0.034,-0.034,-0.032,-0.029,-0.027,-0.024,-0.023,-0.022,-0.021,-0.020,-0.018,-0.016,-0.015,-0.015,-0.014,-0.013,-0.013,-0.014,-0.015,-0.015,-0.016,-0.018,-0.018,-0.018,-0.019,-0.019,-0.021,-0.023,-0.024,-0.025,-0.028,-0.029,-0.030,-0.032,-0.033,-0.033,-0.035,-0.036,-0.037,-0.037,-0.036,-0.036,-0.036,-0.035,-0.035,-0.035,-0.034,-0.034,-0.034,-0.033,-0.031,-0.030,-0.029,-0.028,-0.027,-0.027,-0.025,-0.025,-0.024,-0.025,-0.024,-0.023,-0.022,-0.022,-0.022,-0.022,-0.024,-0.023,-0.023,-0.023,-0.023,-0.024,-0.025,-0.025,-0.024,-0.024,-0.024,-0.025,-0.026,-0.028,-0.028,-0.027,-0.027,-0.026,-0.026,-0.026,-0.027,-0.028,-0.028,-0.029,-0.030,-0.030,-0.030,-0.029,-0.029,-0.031,-0.031,-0.033,-0.034,-0.034,-0.034,-0.033,-0.034,-0.033,-0.033,-0.033,-0.034,-0.034,-0.035,-0.035,-0.033,-0.033,-0.032,-0.032,-0.032,-0.031,-0.029,-0.028,-0.027,-0.027,-0.025,-0.024,-0.023,-0.022,-0.021,-0.019,-0.018,-0.017,-0.016,-0.016,-0.017,-0.016,-0.017,-0.016,-0.016,-0.016,-0.017,-0.019,-0.021,-0.025,-0.027,-0.030,-0.032,-0.034,-0.035,-0.036,-0.036,-0.038,-0.041,-0.043,-0.045,-0.047,-0.048,-0.048,-0.048,-0.049,-0.044,-0.036,-0.031,-0.021,-0.023,-0.038,-0.044,-0.046,-0.046,-0.041,-0.036,-0.032,-0.027,-0.023,-0.018,-0.015,-0.012,-0.009,-0.006,-0.002,0.001,0.001,0.003,0.002,0.000,-0.002,-0.004,-0.007,-0.010,-0.012,-0.014,-0.018,-0.023,-0.029,-0.032,-0.037,-0.042,-0.047,-0.051,-0.054,-0.057,-0.061,-0.065,-0.069,-0.071,-0.073,-0.074,-0.074,-0.072,-0.069,-0.067,-0.062,-0.058,-0.054,-0.050,-0.045,-0.039,-0.032,-0.026,-0.021,-0.016,-0.011,-0.006,-0.001,0.002,0.007,0.012,0.015,0.018,0.019,0.019,0.018,0.016,0.014,0.011,0.008,0.003,-0.004,-0.009,-0.015,-0.023,-0.030,-0.037,-0.043,-0.050,-0.055,-0.061,-0.067,-0.073,-0.077,-0.081,-0.085,-0.088,-0.088,-0.090,-0.090,-0.089,-0.086,-0.082,-0.076,-0.070,-0.063,-0.058,-0.052,-0.044,-0.037,-0.028,-0.019,-0.010,-0.003,0.004,0.011,0.015,0.021,0.025,0.029,0.031,0.033,0.034,0.032,0.030,0.027,0.024,0.020,0.014,0.008,0.000,-0.009,-0.017,-0.027,-0.034,-0.043,-0.051,-0.062,-0.071,-0.079,-0.087,-0.092,-0.097,-0.101,-0.104,-0.107,-0.108,-0.109,-0.108,-0.107,-0.102,-0.096,-0.089,-0.082,-0.072,-0.063,-0.055,-0.045,-0.035,-0.025,-0.014,-0.003,0.007,0.017,0.026,0.034,0.041,0.045,0.049,0.051,0.053,0.054,0.053,0.052,0.046,0.041,0.033,0.025,0.016,0.005,-0.006,-0.016,-0.028,-0.039,-0.050,-0.063,-0.076,-0.087,-0.096,-0.105,-0.113,-0.121,-0.128,-0.132,-0.135,-0.136,-0.135,-0.132,-0.129,-0.121,-0.113,-0.104,-0.095,-0.084,-0.073,-0.060,-0.046,-0.032,-0.018,-0.004,0.009,0.022,0.035,0.046,0.056,0.066,0.073,0.078,0.081,0.082,0.081,0.077,0.073,0.066,0.058,0.047,0.036,0.026,0.012,-0.001,-0.017,-0.034,-0.050,-0.066,-0.082,-0.096,-0.109,-0.122,-0.133,-0.144,-0.154,-0.161,-0.164,-0.168,-0.167,-0.163,-0.158,-0.151,-0.143,-0.134,-0.121,-0.107,-0.091,-0.074,-0.055,-0.038,-0.021,-0.003,0.015,0.032,0.048,0.061,0.073,0.085,0.095,0.104,0.110,0.112,0.112,0.109,0.103,0.096,0.086,0.075,0.061,0.046,0.029,0.010,-0.009,-0.029,-0.049,-0.070,-0.090,-0.109,-0.127,-0.143,-0.159,-0.172,-0.181,-0.190,-0.196,-0.197,-0.199,-0.197,-0.192,-0.182,-0.171,-0.158,-0.144,-0.126,-0.108,-0.088,-0.069,-0.046,-0.023,0.000,0.021,0.042,0.061,0.078,0.094,0.108,0.120,0.130,0.137,0.140,0.140,0.139,0.133,0.125,0.114,0.098,0.081,0.063,0.042,0.020,-0.004,-0.027,-0.049,-0.073,-0.094,-0.116,-0.137,-0.157,-0.176,-0.190,-0.203,-0.214,-0.222,-0.228,-0.228,-0.225,-0.219,-0.211,-0.199,-0.184,-0.166,-0.147,-0.126,-0.104,-0.079,-0.053,-0.027,-0.003,0.022,0.044,0.067,0.088,0.107,0.124,0.140,0.151,0.159,0.163,0.166,0.163,0.157,0.148,0.136,0.121,0.105,0.084,0.061,0.036,0.010,-0.017,-0.043,-0.068,-0.096,-0.122,-0.147,-0.170,-0.191,-0.208,-0.223,-0.236,-0.245,-0.251,-0.253,-0.251,-0.246,-0.237,-0.226,-0.211,-0.193,-0.171,-0.147,-0.123,-0.096,-0.066,-0.038,-0.009,0.017,0.043,0.067,0.092,0.115,0.136,0.154,0.168,0.178,0.184,0.187,0.187,0.182,0.174,0.162,0.147,0.128,0.108,0.084,0.057,0.029,0.001,-0.029,-0.060,-0.090,-0.119,-0.146,-0.173,-0.197,-0.220,-0.238,-0.253,-0.265,-0.274,-0.278,-0.279,-0.276,-0.267,-0.255,-0.239,-0.219,-0.198,-0.174,-0.146,-0.118,-0.088,-0.055,-0.024,0.008,0.038,0.067,0.095,0.122,0.146,0.167,0.184,0.197,0.206,0.212,0.212,0.209,0.201,0.191,0.175,0.155,0.132,0.106,0.078,0.048,0.016,-0.017,-0.051,-0.084,-0.115,-0.147,-0.177,-0.205,-0.231,-0.253,-0.272,-0.286,-0.297,-0.303,-0.304,-0.301,-0.293,-0.281,-0.267,-0.247,-0.224,-0.197,-0.167,-0.136,-0.103,-0.068,-0.033,0.000,0.035,0.067,0.100,0.130,0.157,0.179,0.197,0.213,0.225,0.231,0.232,0.230,0.225,0.214,0.198,0.177,0.153,0.126,0.097,0.064,0.030,-0.006,-0.043,-0.080,-0.115,-0.149,-0.183,-0.214,-0.243,-0.267,-0.287,-0.303,-0.315,-0.323,-0.325,-0.322,-0.316,-0.304,-0.289,-0.268,-0.245,-0.217,-0.185,-0.151,-0.115,-0.078,-0.042,-0.006,0.030,0.066,0.100,0.132,0.160,0.186,0.208,0.225,0.239,0.248,0.251,0.249,0.241,0.229,0.213,0.194,0.171,0.143,0.111,0.077,0.040,0.002,-0.036,-0.074,-0.112,-0.147,-0.183,-0.216,-0.245,-0.272,-0.294,-0.313,-0.327,-0.336,-0.338,-0.336,-0.329,-0.320,-0.304,-0.285,-0.261,-0.234,-0.203,-0.168,-0.132,-0.093,-0.054,-0.014,0.025,0.062,0.097,0.130,0.161,0.187,0.210,0.230,0.244,0.254,0.260,0.260,0.254,0.243,0.228,0.208,0.184,0.156,0.125,0.091,0.055,0.016,-0.023,-0.062,-0.101,-0.140,-0.176,-0.211,-0.243,-0.271,-0.296,-0.317,-0.334,-0.345,-0.351,-0.352,-0.347,-0.336,-0.322,-0.302,-0.278,-0.251,-0.220,-0.186,-0.149,-0.111,-0.070,-0.029,0.012,0.052,0.088,0.123,0.155,0.185,0.211,0.232,0.248,0.260,0.268,0.271,0.267,0.259,0.244,0.226,0.202,0.175,0.144,0.109,0.072,0.032,-0.009,-0.051,-0.092,-0.132,-0.171,-0.208,-0.243,-0.273,-0.299,-0.321,-0.340,-0.353,-0.361,-0.363,-0.360,-0.352,-0.338,-0.319,-0.295,-0.269,-0.238,-0.203,-0.167,-0.127,-0.086,-0.043,-0.001,0.039,0.079,0.117,0.153,0.185,0.213,0.236,0.256,0.269,0.277,0.280,0.279,0.271,0.259,0.241,0.218,0.190,0.158,0.122,0.083,0.043,0.002,-0.040,-0.081,-0.124,-0.165,-0.205,-0.240,-0.273,-0.303,-0.326,-0.346,-0.361,-0.370,-0.374,-0.373,-0.365,-0.351,-0.333,-0.311,-0.284,-0.252,-0.217,-0.180,-0.140,-0.097,-0.054,-0.009,0.033,0.073,0.113,0.149,0.182,0.211,0.237,0.257,0.273,0.284,0.289,0.287,0.281,0.268,0.250,0.226,0.200,0.168,0.133,0.095,0.053,0.011,-0.030,-0.073,-0.116,-0.159,-0.199,-0.237,-0.271,-0.301,-0.326,-0.347,-0.363,-0.375,-0.380,-0.379,-0.373,-0.361,-0.343,-0.321,-0.297,-0.266,-0.231,-0.192,-0.150,-0.108,-0.064,-0.020,0.024,0.068,0.107,0.144,0.178,0.209,0.236,0.259,0.275,0.286,0.291,0.292,0.285,0.274,0.256,0.234,0.207,0.177,0.141,0.104,0.064,0.022,-0.021,-0.066,-0.110,-0.153,-0.195,-0.233,-0.268,-0.299,-0.326,-0.350,-0.367,-0.378,-0.384,-0.384,-0.378,-0.366,-0.350,-0.329,-0.301,-0.272,-0.237,-0.197,-0.157,-0.117,-0.075,-0.030,0.014,0.057,0.099,0.137,0.174,0.205,0.230,0.251,0.268,0.281,0.288,0.291,0.287,0.276,0.260,0.237,0.212,0.183,0.150,0.112,0.072,0.030,-0.014,-0.059,-0.103,-0.146,-0.186,-0.223,-0.259,-0.290,-0.318,-0.342,-0.361,-0.373,-0.380,-0.382,-0.378,-0.368,-0.353,-0.333,-0.307,-0.278,-0.245,-0.209,-0.170,-0.128,-0.085,-0.042,0.002,0.044,0.085,0.124,0.160,0.192,0.219,0.242,0.261,0.276,0.285,0.287,0.282,0.272,0.258,0.240,0.217,0.189,0.156,0.120,0.080,0.039,-0.003,-0.046,-0.090,-0.131,-0.173,-0.212,-0.247,-0.279,-0.309,-0.331,-0.352,-0.367,-0.375,-0.378,-0.375,-0.367,-0.354,-0.336,-0.313,-0.284,-0.251,-0.218,-0.182,-0.142,-0.099,-0.056,-0.012,0.031,0.072,0.111,0.147,0.179,0.207,0.231,0.251,0.265,0.275,0.279,0.277,0.270,0.258,0.240,0.217,0.192,0.162,0.128,0.091,0.051,0.010,-0.032,-0.074,-0.115,-0.156,-0.197,-0.234,-0.267,-0.296,-0.321,-0.342,-0.358,-0.368,-0.372,-0.371,-0.365,-0.354,-0.337,-0.315,-0.291,-0.261,-0.228,-0.191,-0.152,-0.112,-0.071,-0.028,0.013,0.053,0.091,0.127,0.159,0.190,0.216,0.238,0.255,0.266,0.271,0.272,0.267,0.256,0.242,0.222,0.199,0.169,0.135,0.099,0.061,0.021,-0.020,-0.060,-0.102,-0.143,-0.182,-0.218,-0.251,-0.277,-0.278,-0.268,-0.251,-0.273,-0.353,-0.400,-0.419,-0.421,-0.409,-0.386,-0.359,-0.326,-0.285,-0.243,-0.199,-0.152,-0.102,-0.053,-0.004,0.043,0.086,0.128,0.166,0.201,0.232,0.259,0.280,0.295,0.306,0.309,0.306,0.298,0.283,0.263,0.238,0.208,0.172,0.133,0.092,0.050,0.004,-0.042,-0.089,-0.135,-0.180,-0.221,-0.259,-0.293,-0.324,-0.351,-0.373,-0.386,-0.398,-0.403,-0.401,-0.393,-0.380,-0.362,-0.338,-0.307,-0.274,-0.237,-0.198,-0.155,-0.110,-0.065,-0.020,0.024,0.067,0.107,0.147,0.183,0.214,0.242,0.263,0.278,0.288,0.294,0.295,0.289,0.278,0.262,0.238,0.209,0.177,0.143,0.105,0.064,0.021,-0.023,-0.068,-0.113,-0.156,-0.197,-0.235,-0.270,-0.303,-0.330,-0.353,-0.372,-0.383,-0.388,-0.388,-0.383,-0.372,-0.356,-0.335,-0.310,-0.281,-0.247,-0.210,-0.169,-0.126,-0.083,-0.042,0.001,0.043,0.084,0.123,0.159,0.190,0.215,0.236,0.254,0.268,0.277,0.281,0.279,0.269,0.254,0.235,0.209,0.182,0.151,0.116,0.077,0.036,-0.005,-0.048,-0.090,-0.131,-0.171,-0.210,-0.245,-0.278,-0.306,-0.329,-0.348,-0.361,-0.370,-0.374,-0.372,-0.366,-0.353,-0.335,-0.312,-0.284,-0.252,-0.218,-0.182,-0.145,-0.105,-0.064,-0.023,0.018,0.058,0.097,0.131,0.162,0.188,0.211,0.232,0.248,0.258,0.264,0.262,0.255,0.244,0.229,0.210,0.185,0.157,0.123,0.086,0.048,0.012,-0.027,-0.068,-0.107,-0.145,-0.184,-0.221,-0.253,-0.280,-0.303,-0.322,-0.339,-0.349,-0.354,-0.356,-0.353,-0.343,-0.327,-0.307,-0.283,-0.256,-0.226,-0.194,-0.158,-0.122,-0.083,-0.045,-0.006,0.032,0.069,0.103,0.133,0.161,0.185,0.204,0.221,0.232,0.239,0.240,0.238,0.233,0.221,0.204,0.182,0.155,0.127,0.095,0.061,0.027,-0.009,-0.045,-0.083,-0.121,-0.157,-0.190,-0.221,-0.250,-0.275,-0.296,-0.312,-0.325,-0.334,-0.337,-0.335,-0.328,-0.317,-0.302,-0.284,-0.260,-0.234,-0.203,-0.171,-0.137,-0.103,-0.066,-0.031,0.004,0.039,0.072,0.103,0.131,0.156,0.178,0.193,0.205,0.214,0.219,0.219,0.216,0.207,0.194,0.178,0.157,0.132,0.105,0.074,0.040,0.006,-0.027,-0.061,-0.095,-0.127,-0.159,-0.191,-0.220,-0.245,-0.267,-0.285,-0.300,-0.309,-0.315,-0.316,-0.314,-0.306,-0.294,-0.278,-0.259,-0.234,-0.207,-0.180,-0.152,-0.121,-0.090,-0.057,-0.025,0.009,0.042,0.073,0.100,0.125,0.147,0.165,0.180,0.190,0.197,0.199,0.198,0.193,0.184,0.170,0.154,0.133,0.108,0.081,0.052,0.021,-0.010,-0.041,-0.072,-0.103,-0.134,-0.165,-0.193,-0.218,-0.241,-0.259,-0.273,-0.282,-0.289,-0.294,-0.293,-0.289,-0.282,-0.271,-0.256,-0.238,-0.214,-0.188,-0.161,-0.134,-0.104,-0.076,-0.045,-0.015,0.015,0.043,0.070,0.094,0.117,0.136,0.151,0.162,0.170,0.175,0.178,0.176,0.170,0.160,0.145,0.129,0.108,0.087,0.062,0.033,0.004,-0.026,-0.054,-0.081,-0.109,-0.134,-0.160,-0.185,-0.208,-0.228,-0.244,-0.258,-0.266,-0.271,-0.273,-0.271,-0.266,-0.259,-0.248,-0.233,-0.214,-0.192,-0.168,-0.145,-0.119,-0.092,-0.064,-0.037,-0.009,0.018,0.042,0.064,0.085,0.104,0.120,0.134,0.143,0.150,0.153,0.151,0.148,0.142,0.134,0.122,0.106,0.087,0.065,0.041,0.017,-0.008,-0.034,-0.060,-0.086,-0.111,-0.135,-0.160,-0.181,-0.199,-0.215,-0.228,-0.238,-0.245,-0.249,-0.251,-0.248,-0.243,-0.235,-0.224,-0.209,-0.192,-0.173,-0.151,-0.128,-0.105,-0.081,-0.058,-0.034,-0.011,0.012,0.033,0.056,0.076,0.091,0.104,0.115,0.121,0.127,0.129,0.129,0.126,0.119,0.109,0.098,0.082,0.065,0.047,0.026,0.004,-0.019,-0.042,-0.065,-0.088,-0.110,-0.131,-0.152,-0.171,-0.187,-0.200,-0.209,-0.217,-0.223,-0.227,-0.228,-0.225,-0.220,-0.213,-0.203,-0.189,-0.173,-0.156,-0.136,-0.117,-0.096,-0.074,-0.054,-0.032,-0.011,0.010,0.029,0.048,0.063,0.078,0.089,0.098,0.103,0.106,0.106,0.104,0.100,0.094,0.087,0.075,0.062,0.046,0.029,0.011,-0.008,-0.027,-0.049,-0.069,-0.088,-0.108,-0.126,-0.142,-0.158,-0.172,-0.183,-0.193,-0.200,-0.203,-0.205,-0.205,-0.202,-0.196,-0.189,-0.179,-0.168,-0.154,-0.140,-0.125,-0.108,-0.089,-0.069,-0.050,-0.032,-0.015,0.002,0.019,0.034,0.048,0.058,0.067,0.076,0.080,0.084,0.084,0.082,0.078,0.073,0.066,0.055,0.044,0.032,0.017,0.000,-0.017,-0.035,-0.052,-0.068,-0.084,-0.101,-0.114,-0.129,-0.144,-0.157,-0.167,-0.175,-0.181,-0.184,-0.185,-0.185,-0.182,-0.176,-0.170,-0.163,-0.153,-0.140,-0.127,-0.114,-0.099,-0.083,-0.066,-0.050,-0.035,-0.021,-0.006,0.006,0.019,0.031,0.041,0.049,0.056,0.060,0.063,0.063,0.061,0.057,0.053,0.046,0.039,0.030,0.018,0.006,-0.008,-0.024,-0.039,-0.053,-0.066,-0.079,-0.094,-0.108,-0.121,-0.132,-0.142,-0.150,-0.155,-0.160,-0.163,-0.164,-0.165,-0.163,-0.159,-0.153,-0.147,-0.139,-0.128,-0.117,-0.105,-0.092,-0.079,-0.066,-0.053,-0.041,-0.028,-0.016,-0.005,0.006,0.017,0.025,0.033,0.041,0.043,0.044,0.043,0.042,0.040,0.035,0.029,0.022,0.013,0.004,-0.005,-0.015,-0.028,-0.041,-0.053,-0.065,-0.077,-0.087,-0.098,-0.108,-0.117,-0.126,-0.132,-0.137,-0.141,-0.143,-0.145,-0.146,-0.145,-0.141,-0.138,-0.134,-0.126,-0.118,-0.109,-0.099,-0.089,-0.079,-0.067,-0.056,-0.047,-0.036,-0.025,-0.014,-0.005,0.003,0.011,0.016,0.021,0.023,0.026,0.026,0.026,0.023,0.018,0.014,0.009,0.004,-0.004,-0.015,-0.026,-0.035,-0.044,-0.053,-0.063,-0.071,-0.081,-0.090,-0.098,-0.105,-0.111,-0.117,-0.121,-0.125,-0.128,-0.128,-0.129,-0.128,-0.124,-0.121,-0.118,-0.113,-0.107,-0.100,-0.090,-0.081,-0.075,-0.067,-0.058,-0.050,-0.044,-0.036,-0.027,-0.019,-0.012,-0.006,-0.003,0.002,0.004,0.004,0.004,0.004,0.005,0.003,0.000,-0.004,-0.009,-0.013,-0.019,-0.026,-0.034,-0.042,-0.051,-0.060,-0.065,-0.071,-0.076,-0.082,-0.089,-0.097,-0.103,-0.108,-0.112,-0.114,-0.114,-0.114,-0.113,-0.113,-0.112,-0.108,-0.104,-0.099,-0.095,-0.089,-0.082,-0.076,-0.068,-0.062,-0.056,-0.049,-0.042,-0.037,-0.031,-0.026,-0.021,-0.017,-0.013,-0.012,-0.009,-0.008,-0.007,-0.008,-0.009,-0.011,-0.014,-0.017,-0.021,-0.025,-0.031,-0.037,-0.042,-0.047,-0.053,-0.058,-0.065,-0.070,-0.076,-0.083,-0.086,-0.089,-0.092,-0.096,-0.098,-0.100,-0.101,-0.101,-0.101,-0.099,-0.097,-0.095,-0.092,-0.090,-0.089,-0.084,-0.078,-0.071,-0.066,-0.061,-0.055,-0.050,-0.046,-0.043,-0.038,-0.033,-0.029,-0.025,-0.023,-0.021,-0.021,-0.020,-0.019,-0.019,-0.019,-0.021,-0.024,-0.026,-0.028,-0.032,-0.036,-0.040,-0.044,-0.047,-0.051,-0.055,-0.060,-0.065,-0.070,-0.075,-0.078,-0.081,-0.084,-0.085,-0.087,-0.088,-0.088,-0.089,-0.091,-0.091,-0.090,-0.087,-0.084,-0.080,-0.075,-0.074,-0.071,-0.069,-0.066,-0.062,-0.057,-0.053,-0.050,-0.045,-0.042,-0.039,-0.035,-0.032,-0.031,-0.028,-0.027,-0.027,-0.026,-0.026,-0.026,-0.027,-0.028,-0.030,-0.032,-0.033,-0.035,-0.038,-0.040,-0.043,-0.048,-0.052,-0.057,-0.062,-0.064,-0.067,-0.069,-0.071,-0.073,-0.073,-0.075,-0.077,-0.079,-0.081,-0.082,-0.082,-0.081,-0.081,-0.080,-0.079,-0.079,-0.075,-0.071,-0.068,-0.066,-0.063,-0.061,-0.058,-0.054,-0.049,-0.045,-0.041,-0.040,-0.037,-0.036,-0.035,-0.033,-0.031,-0.029,-0.029,-0.028,-0.029,-0.030,-0.030,-0.032,-0.033,-0.035,-0.037,-0.040,-0.042,-0.044,-0.046,-0.050,-0.052,-0.055,-0.057,-0.060,-0.064,-0.068,-0.071,-0.073,-0.074,-0.074,-0.075,-0.076,-0.077,-0.077,-0.078,-0.076,-0.076,-0.074,-0.074,-0.072,-0.070,-0.068,-0.064,-0.061,-0.058,-0.055,-0.053,-0.051,-0.049,-0.047,-0.045,-0.037,-0.031,-0.029,-0.004,-0.018,-0.028,-0.034,-0.037,-0.036,-0.037,-0.036,-0.035,-0.033,-0.034,-0.036,-0.037,-0.040,-0.044,-0.048,-0.049,-0.052,-0.054,-0.057,-0.061,-0.066,-0.069,-0.072,-0.074,-0.073,-0.074,-0.076,-0.077,-0.079,-0.080,-0.082,-0.081,-0.079,-0.077,-0.076,-0.075,-0.075,-0.071,-0.068,-0.065,-0.062,-0.059,-0.057,-0.052,-0.047,-0.043,-0.041,-0.038,-0.036,-0.032,-0.031,-0.029,-0.028,-0.026,-0.025,-0.025,-0.025,-0.024,-0.025,-0.027,-0.030,-0.032,-0.035,-0.038,-0.039,-0.042,-0.045,-0.048,-0.052,-0.056,-0.060,-0.063,-0.068,-0.071,-0.071,-0.074,-0.077,-0.079,-0.081,-0.082,-0.083,-0.081,-0.080,-0.078,-0.075,-0.076,-0.075,-0.073,-0.070,-0.068,-0.065,-0.060,-0.057,-0.054,-0.048,-0.043,-0.038,-0.036,-0.032,-0.031,-0.030,-0.030,-0.028,-0.025,-0.022,-0.020,-0.019,-0.022,-0.023,-0.025,-0.027,-0.030,-0.032,-0.033,-0.035,-0.038,-0.042,-0.047,-0.052,-0.057,-0.060,-0.064,-0.066,-0.068,-0.069,-0.073,-0.078,-0.082,-0.082,-0.082,-0.082,-0.082,-0.083,-0.082,-0.081,-0.077,-0.075,-0.073,-0.072,-0.068,-0.065,-0.060,-0.052,-0.049,-0.047,-0.043,-0.041,-0.038,-0.034,-0.030,-0.026,-0.024,-0.021,-0.019,-0.018,-0.019,-0.021,-0.022,-0.022,-0.024,-0.024,-0.026,-0.029,-0.032,-0.035,-0.037,-0.041,-0.045,-0.050,-0.052,-0.057,-0.061,-0.064,-0.071,-0.075,-0.078,-0.081,-0.083,-0.084,-0.083,-0.083,-0.084,-0.084,-0.084,-0.081,-0.078,-0.075,-0.074,-0.071,-0.068,-0.064,-0.058,-0.053,-0.050,-0.045,-0.042,-0.038,-0.034,-0.030,-0.028,-0.025,-0.019,-0.018,-0.016,-0.014,-0.015,-0.017,-0.018,-0.019,-0.020,-0.021,-0.022,-0.026,-0.030,-0.034,-0.039,-0.044,-0.047,-0.052,-0.057,-0.061,-0.062,-0.067,-0.070,-0.072,-0.077,-0.081,-0.083,-0.086,-0.089,-0.090,-0.089,-0.087,-0.083,-0.080,-0.079,-0.076,-0.074,-0.069,-0.065,-0.060,-0.054,-0.050,-0.044,-0.042,-0.038,-0.034,-0.030,-0.027,-0.023,-0.018,-0.015,-0.012,-0.011,-0.012,-0.012,-0.013,-0.013,-0.014,-0.015,-0.019,-0.024,-0.028,-0.031,-0.036,-0.041,-0.047,-0.050,-0.056,-0.060,-0.063,-0.068,-0.073,-0.079,-0.083,-0.085,-0.088,-0.090,-0.093,-0.091,-0.089,-0.090,-0.087,-0.084,-0.082,-0.077,-0.072,-0.067,-0.064,-0.058,-0.054,-0.050,-0.045,-0.039,-0.032,-0.027,-0.022,-0.019,-0.015,-0.013,-0.011,-0.009,-0.007,-0.007,-0.005,-0.007,-0.008,-0.012,-0.015,-0.016,-0.020,-0.026,-0.033,-0.040,-0.045,-0.050,-0.055,-0.061,-0.066,-0.070,-0.073,-0.076,-0.081,-0.083,-0.087,-0.090,-0.091,-0.093,-0.092,-0.090,-0.090,-0.088,-0.085,-0.082,-0.077,-0.072,-0.068,-0.064,-0.059,-0.051,-0.044,-0.036,-0.032,-0.029,-0.025,-0.020,-0.016,-0.011,-0.009,-0.007,-0.005,-0.002,-0.003,-0.005,-0.007,-0.008,-0.010,-0.014,-0.016,-0.022,-0.027,-0.033,-0.040,-0.046,-0.052,-0.058,-0.066,-0.070,-0.072,-0.078,-0.082,-0.086,-0.089,-0.093,-0.095,-0.095,-0.094,-0.093,-0.092,-0.091,-0.089,-0.085,-0.082,-0.077,-0.073,-0.065,-0.059,-0.052,-0.043,-0.037,-0.031,-0.026,-0.022,-0.016,-0.010,-0.006,-0.002,-0.001,-0.001,-0.001,0.001,0.000,-0.002,-0.005,-0.009,-0.013,-0.017,-0.021,-0.027,-0.033,-0.039,-0.045,-0.051,-0.057,-0.061,-0.068,-0.074,-0.078,-0.085,-0.089,-0.092,-0.095,-0.097,-0.099,-0.099,-0.099,-0.095,-0.091,-0.090,-0.087,-0.082,-0.077,-0.071,-0.064,-0.056,-0.049,-0.043,-0.036,-0.031,-0.025,-0.020,-0.015,-0.011,-0.008,-0.005,0.000,0.005,0.007,0.007,0.006,0.004,0.001,-0.004,-0.009,-0.015,-0.019,-0.024,-0.029,-0.034,-0.041,-0.049,-0.057,-0.064,-0.070,-0.078,-0.084,-0.088,-0.091,-0.093,-0.096,-0.100,-0.102,-0.102,-0.099,-0.100,-0.097,-0.092,-0.088,-0.082,-0.077,-0.072,-0.065,-0.059,-0.052,-0.045,-0.037,-0.028,-0.022,-0.016,-0.011,-0.006,-0.002,0.003,0.006,0.009,0.011,0.012,0.012,0.011,0.007,0.004,-0.001,-0.007,-0.014,-0.021,-0.026,-0.034,-0.042,-0.050,-0.058,-0.067,-0.076,-0.082,-0.088,-0.093,-0.096,-0.101,-0.103,-0.106,-0.106,-0.106,-0.106,-0.104,-0.102,-0.096,-0.091,-0.087,-0.081,-0.074,-0.067,-0.058,-0.050,-0.042,-0.033,-0.025,-0.017,-0.010,-0.002,0.003,0.006,0.009,0.011,0.013,0.014,0.017,0.017,0.014,0.013,0.008,0.004,-0.002,-0.008,-0.016,-0.024,-0.032,-0.041,-0.049,-0.057,-0.066,-0.075,-0.083,-0.089,-0.096,-0.102,-0.105,-0.107,-0.111,-0.112,-0.113,-0.111,-0.108,-0.106,-0.103,-0.098,-0.091,-0.086,-0.079,-0.069,-0.060,-0.051,-0.042,-0.033,-0.024,-0.014,-0.005,0.000,0.006,0.012,0.017,0.022,0.025,0.025,0.025,0.025,0.023,0.020,0.017,0.009,0.002,-0.005,-0.012,-0.021,-0.031,-0.040,-0.052,-0.062,-0.071,-0.081,-0.090,-0.095,-0.100,-0.106,-0.110,-0.114,-0.116,-0.119,-0.121,-0.119,-0.116,-0.113,-0.108,-0.103,-0.095,-0.086,-0.079,-0.069,-0.060,-0.051,-0.042,-0.032,-0.019,-0.010,0.000,0.008,0.013,0.020,0.025,0.029,0.032,0.034,0.033,0.031,0.028,0.025,0.019,0.015,0.009,0.002,-0.008,-0.018,-0.028,-0.039,-0.049,-0.059,-0.069,-0.081,-0.092,-0.103,-0.111,-0.115,-0.119,-0.122,-0.124,-0.126,-0.126,-0.124,-0.122,-0.118,-0.112,-0.104,-0.096,-0.088,-0.078,-0.069,-0.058,-0.049,-0.040,-0.031,-0.021,-0.008,0.003,0.013,0.021,0.026,0.031,0.034,0.036,0.037,0.038,0.039,0.035,0.032,0.027,0.019,0.013,0.004,-0.005,-0.016,-0.027,-0.039,-0.052,-0.062,-0.072,-0.082,-0.092,-0.102,-0.110,-0.117,-0.122,-0.126,-0.130,-0.129,-0.126,-0.124,-0.123,-0.121,-0.117,-0.112,-0.105,-0.096,-0.086,-0.074,-0.063,-0.050,-0.037,-0.028,-0.018,-0.007,0.004,0.011,0.019,0.027,0.034,0.041,0.045,0.047,0.045,0.042,0.040,0.036,0.033,0.028,0.020,0.012,0.000,-0.011,-0.023,-0.035,-0.047,-0.058,-0.068,-0.080,-0.091,-0.100,-0.109,-0.115,-0.121,-0.127,-0.131,-0.133,-0.134,-0.135,-0.132,-0.128,-0.123,-0.116,-0.108,-0.099,-0.090,-0.079,-0.066,-0.055,-0.043,-0.030,-0.020,-0.010,0.000,0.011,0.021,0.031,0.039,0.041,0.045,0.049,0.048,0.046,0.045,0.041,0.036,0.033,0.027,0.019,0.009,-0.003,-0.016,-0.028,-0.039,-0.051,-0.062,-0.074,-0.084,-0.094,-0.105,-0.115,-0.122,-0.130,-0.135,-0.138,-0.138,-0.137,-0.135,-0.132,-0.127,-0.122,-0.115,-0.107,-0.098,-0.088,-0.075,-0.061,-0.048,-0.035,-0.023,-0.012,-0.002,0.010,0.020,0.028,0.038,0.045,0.047,0.051,0.053,0.053,0.052,0.048,0.045,0.038,0.030,0.022,0.012,0.001,-0.009,-0.021,-0.032,-0.042,-0.055,-0.067,-0.079,-0.091,-0.103,-0.112,-0.121,-0.128,-0.133,-0.137,-0.140,-0.139,-0.138,-0.137,-0.133,-0.127,-0.120,-0.110,-0.099,-0.089,-0.080,-0.069,-0.056,-0.043,-0.028,-0.015,-0.003,0.008,0.017,0.026,0.032,0.039,0.045,0.048,0.052,0.054,0.050,0.050,0.047,0.043,0.037,0.029,0.022,0.010,-0.001,-0.014,-0.026,-0.041,-0.053,-0.065,-0.075,-0.084,-0.095,-0.105,-0.115,-0.123,-0.128,-0.133,-0.135,-0.138,-0.137,-0.135,-0.132,-0.127,-0.121,-0.113,-0.104,-0.095,-0.084,-0.073,-0.061,-0.048,-0.038,-0.028,-0.016,-0.003,0.009,0.020,0.029,0.037,0.045,0.050,0.051,0.053,0.054,0.053,0.051,0.047,0.041,0.031,0.022,0.013,0.001,-0.010,-0.021,-0.033,-0.044,-0.055,-0.066,-0.078,-0.087,-0.096,-0.107,-0.115,-0.123,-0.128,-0.131,-0.132,-0.134,-0.133,-0.132,-0.129,-0.123,-0.116,-0.107,-0.098,-0.088,-0.076,-0.066,-0.053,-0.042,-0.031,-0.019,-0.008,0.001,0.011,0.019,0.027,0.033,0.039,0.044,0.048,0.050,0.051,0.048,0.046,0.040,0.033,0.027,0.018,0.008,-0.004,-0.014,-0.025,-0.036,-0.047,-0.059,-0.070,-0.081,-0.091,-0.100,-0.107,-0.113,-0.118,-0.123,-0.114,-0.088,-0.069,-0.056,-0.052,-0.102,-0.129,-0.138,-0.136,-0.128,-0.115,-0.101,-0.085,-0.070,-0.055,-0.040,-0.027,-0.014,0.000,0.012,0.025,0.032,0.037,0.041,0.043,0.047,0.049,0.050,0.047,0.043,0.037,0.027,0.018,0.012,0.006,-0.003,-0.013,-0.024,-0.038,-0.050,-0.062,-0.073,-0.084,-0.093,-0.100,-0.108,-0.116,-0.123,-0.128,-0.130,-0.132,-0.131,-0.128,-0.128,-0.122,-0.116,-0.107,-0.099,-0.089,-0.080,-0.068,-0.057,-0.046,-0.036,-0.026,-0.015,-0.006};
double vImag[samples];

#define SCL_INDEX 0x00
#define SCL_TIME 0x01
#define SCL_FREQUENCY 0x02
#define SCL_PLOT 0x03

// variable for feature extraction
double stad=0.0;
double skew = 0.0;
double kurt = 0.0;
double mue = 0.0;
double x;
double max_fft=0;
int max_fft_id=0;
int upper_band=0;
int under_band=0;  
int upper_band_2=0;
int under_band_2=0; 

void setup()
{
  Serial.begin(115200);
  Serial.println("Ready");
}

void loop()
{
  /* Build raw data */
  double cycles = (((samples-1) * signalFrequency) / samplingFrequency); //Number of signal cycles that the sampling will read
  for (uint16_t i = 0; i < samples; i++)
  {
    //vReal[i] = int8_t((amplitude * (sin((i * (twoPi * cycles)) / samples))) / 2.0);/* Build data with positive and negative values*/
    //vReal[i] = uint8_t((amplitude * (sin((i * (twoPi * cycles)) / samples) + 1.0)) / 2.0);/* Build data displaced on the Y axis to include only positive values*/
    vImag[i] = 0.0; //Imaginary part must be zeroed in case of looping to avoid wrong calculations and overflows
  }
  /* Print the results of the simulated sampling according to time */
  FFT.Compute(vReal, vImag,  samples, SCL_INDEX); /* Compute FFT */
  FFT.ComplexToMagnitude(vReal, vImag, samples);
  Serial.println("Computed Real values:");
  PrintVector(vReal, samples, SCL_INDEX);
  
 
  x = FFT.MajorPeak(vReal, samples, samplingFrequency);
  Serial.println(x, 6);
  
  while(1); /* Run Once */
  // delay(2000); /* Repeat after delay */

  /*calculation of the maximum of the signal and the position of the maximum
    Standardabweichung. wölbung, schiefe, bandbreite und mittenfrequenz1  1 1^
  */

  
}

void PrintVector(double *vData, uint16_t bufferSize, uint8_t scaleType)
{
  for (uint16_t i = 0; i < bufferSize; i++)
  {
    double abscissa;
    /* Print abscissa value */
    switch (scaleType)
    {
      case SCL_INDEX:
        abscissa = (i * 1.0);
  break;
      case SCL_TIME:
        abscissa = ((i * 1.0) / samplingFrequency);
  break;
      case SCL_FREQUENCY:
        abscissa = ((i * 1.0 * samplingFrequency) / samples);
  break;
    }
    Serial.print(abscissa, 6);
    if(scaleType==SCL_FREQUENCY)
      Serial.print("Hz");
    Serial.print(" ");
    Serial.println(vData[i], 4);
  }
  Serial.println();
  feat_extr();
}

void feat_extr(){
  // clean variables
   stad=0.0;
   skew = 0.0;
   kurt = 0.0;
   mue = 0.0;
   
  //calculate averrage value of the FFT
   for(int i =0; i<samples; i++){
    mue = mue + abs(vReal[i]); 
    
   }
   mue = mue/samples;

   //calculate stad
   for(int i =0; i<samples; i++){
    stad = (abs(vReal[i])-mue)*(abs(vReal[i])-mue)+stad;   
   }
   stad = sqrt(stad/samples);
   

   
    //calculate skew
   for(int i =0; i<samples; i++){
    skew = (abs(vReal[i])-mue)*(abs(vReal[i])-mue)*(abs(vReal[i])-mue)/stad+skew;   
   }
   skew = skew/samples;

   //calculate kurtolios
   for(int i =0; i<samples; i++){
    kurt = (abs(vReal[i])-mue)*(abs(vReal[i])-mue)*(abs(vReal[i])-mue)*(abs(vReal[i])-mue)/stad+skew;              
   }
   kurt = kurt/samples;
   
    //centerfrequency
    x = FFT.MajorPeak(vReal, samples, samplingFrequency);

    Serial.println(mue, 6);Serial.println(stad,6); Serial.println(skew,6);  Serial.println(kurt,6);

   //calculate bandwith and center frequency
   for(int i =0; i<samples; i++){
    if(vReal[i]>max_fft){
      max_fft=vReal[i];
      max_fft_id=i;
     
    }
    
   }
   for(int j =max_fft_id; j<samples; j++){
    
     if(vReal[j] <max_fft/2)
      upper_band = j;
      if(vReal[j] <max_fft/3){
        upper_band_2 = j;
        break;
     }
   }
     for(int h =max_fft_id; h>1; h--){
     
      if(vReal[h] <max_fft/2)
      under_band =h;
      if(vReal[h] <max_fft/3){
        under_band_2 = h;
        break;
     
    }
   }
 
   Serial.println("bandbreite für berechnung");Serial.println(upper_band_2,6);Serial.println(under_band_2,6);Serial.println(max_fft, 6);Serial.println(max_fft_id,6);
   Serial.println("Bandwith and center");

   Serial.println(max_fft, 6);Serial.println(max_fft_id,6); Serial.println(upper_band,6);  Serial.println(under_band,6);
   }


   
   
   

  
